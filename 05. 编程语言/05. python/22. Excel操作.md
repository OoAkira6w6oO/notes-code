# 准备工作

- [官方文档](https://openpyxl.readthedocs.io/en/stable/index.html)

> pip install openpyxl

# 常用功能

- Excel样式
- 插入、删除、编辑
- 范围选择

# 代码

```python
import openpyxl

# -----------------------------
# 1. 新建 Excel
# -----------------------------
workbook = openpyxl.Workbook()

# 打开默认 Sheet
sheet1 = workbook.active
sheet1.title = "Sheet1"

# -----------------------------
# 2. 写入单个单元格
# -----------------------------
input_content = "123"
sheet1['A1'] = f"a: {input_content}"

# -----------------------------
# 3. 模拟从数据库游标读取数据并写入
# -----------------------------
# 假设我们有一段从数据库获取的数据
mock_cursor = [
    (1, "Alice"),
    (2, "Bob"),
    (3, "Charlie")
]

# 循环写入，从第二行开始
for idx, rec in enumerate(mock_cursor):
    row_idx = idx + 2  # 因为第一行已写
    sheet1.cell(row=row_idx, column=1).value = rec[0]  # ID
    sheet1.cell(row=row_idx, column=2).value = rec[1]  # Name

# -----------------------------
# 4. 添加新的 Sheet 并写入数据
# -----------------------------
sheet2 = workbook.create_sheet("NewSheet")
sheet2['A2'] = "Hello Excel"

# -----------------------------
# 5. 保存 Excel
# -----------------------------
workbook.save("example.xlsx")

print("Excel 文件已生成：example.xlsx")

```

