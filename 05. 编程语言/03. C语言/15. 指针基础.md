# 指针类型

- 一种类型
- 专门存放其他变量在内存中分配的**存储单元的首地址**

- 指针变量：专门存放地址值的变量

# 指针变量

- `*`代表**指针类型**，前面的类型代表**指针所指向的变量的类型**
- 一个指针变量只能指向同一种类型的变量

## 指针运算符

### &

- 取地址运算符，取得变量的首地址
- 在给指针变量赋值时，需要用他获得地址值

### *

- 间接访问运算符
- 通过指针变量间接访问所指向的变量

### C语言允许对指针变量做自增自减运算

## 代码理解

```C
//1. 指针变量基本定义
float *fp1, *fp2;

//2. 指针变量的赋值和使用
char c;
char *cp;
cp = &c;//给指针赋值
*cp = 'A';//使用指针：等价于c='A'

//3. 定义的同时进行初始化
int i;
int *ip = &i;//一旦将变量i的地址赋给了指针变量ip之后，*ip总是与i等价，除非ip又被设置为指向其它变量
```

# 指针和其他数据结构的组合

## 指针和结构struct

### 组合使用的特点

- 指针可以指向某种结构类型的变量
- 结构的成员可以是指针
- 由于Ｃ语言允许结构的**成员**可以**是指向本结构类型的指针**，所以，可以利用这一特点来构造比较复杂的数据结构，如**链表**和**树**等。

### ->运算符

```C
struct date birthday;
struct date *dp;
dp=&birthday;
(*dp).year=1990; // 等价于dp->year=1990;
```

## 指针和数组

### 代替数组名

- 数组名 = 该数组的第0号元素的地址
  - 但数组名本身是常量，不可随意改变
- 一旦p指向数组中的一个元素，则p+1指向下一个元素

```c
int a[10];
int *ap;
ap = a;//等价于ap=&a[0];
```

### 数组做参数时，用指针替代

```C
//处理字符串——合并两个字符串
void constr(char *str1,char *str2,char *str3)
{
     while(*str1!='\0')
          *str3++=*str1++;
     while(*str2!='\0')
          *str3++=*str2++;
     *str3='\0';
}
```

### 不允许函数返回数组，但函数可以返回指向数组的指针

```C
int *func(int a[])
{
    …
    return a;
}
void main( )
{
    int b[]={1,2,3,4,5,6};
    int *p;
    p=func(b);
    …       //可以利用指针p来访问b数组中的每个元素
}
```

## 指针和字符串

- 在程序中每使用一个字符串常量，Ｃ语言编译系统就产生一个指向该字符串的指针
- 字符数组的管理方式，最开始内存就确定了；指针的管理方式，等待后续分配

## 指针数组

- char *letter[ ]={"AA","BB","CC","DD"};

## 指针做参数

- 采取“值传递”，引用地址才会影响本来的值，否则只影响形参
- 不能返回局部变量的地址——没有意义
- int *fp( );
  - fp( )是一个函数，该函数的返回值是指向整型的指针

## 指针指向函数

- 定义

  - 类型说明符　(*函数指针变量名)(形参表);

- 举例

  - int (*fp)(int);

    - fp 是一个指针

      它指向一个函数

      这个函数的 返回值类型是 int

      这个函数有一个 int 类型的参数

## 指针实现从控制台读命令行参数

- void main(int argc, char *argv[ ])
  - argc存放参数个数
  - argv[]存放字符串们的首地址
  - argv[0]是存放主函数main( )所在源文件名字符串的首地址

# 二级指针

- int p, *p1, **p2;
- 指向指针的指针

```C
int p, *p1, **p2;
p=10; p1=&p; p2=&p1;
```

## 二维数组与二维指针

```C
 #include "stdio.h"
 void main( )
 {
     int a[ ][3]={{1,2,3},{4,5,6}, {7,8,9}};
     int (*p)[3];
     int i, j;
     p=a;
     for(i=0; i<3; i++)
     {
        for(j=0;j<3;j++)
           printf("%d ", *(*(p+i)+j));
           printf("\n");
     }
}
```

